"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([[716035],{15680:(e,t,n)=>{n.d(t,{xA:()=>u,yg:()=>d});var a=n(296540);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var c=a.createContext({}),i=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=i(e.components);return a.createElement(c.Provider,{value:t},e.children)},p="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,s=e.originalType,c=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),p=i(n),m=l,d=p["".concat(c,".").concat(m)]||p[m]||g[m]||s;return n?a.createElement(d,r(r({ref:t},u),{},{components:n})):a.createElement(d,r({ref:t},u))}));function d(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var s=n.length,r=new Array(s);r[0]=m;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o[p]="string"==typeof e?e:l,r[1]=o;for(var i=2;i<s;i++)r[i]=n[i];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},213956:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>g,frontMatter:()=>s,metadata:()=>o,toc:()=>i});var a=n(58168),l=(n(296540),n(15680));const s={title:"\u4f7f\u7528 Doris \u548c LakeSoul",language:"zh-CN"},r=void 0,o={unversionedId:"gettingStarted/tutorials/building-lakehouse/doris-lakesoul",id:"version-2.0/gettingStarted/tutorials/building-lakehouse/doris-lakesoul",title:"\u4f7f\u7528 Doris \u548c LakeSoul",description:"\x3c!--",source:"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-2.0/gettingStarted/tutorials/building-lakehouse/doris-lakesoul.md",sourceDirName:"gettingStarted/tutorials/building-lakehouse",slug:"/gettingStarted/tutorials/building-lakehouse/doris-lakesoul",permalink:"/zh-CN/docs/2.0/gettingStarted/tutorials/building-lakehouse/doris-lakesoul",draft:!1,tags:[],version:"2.0",frontMatter:{title:"\u4f7f\u7528 Doris \u548c LakeSoul",language:"zh-CN"},sidebar:"get-starting",previous:{title:"\u4f7f\u7528 Doris \u548c Iceberg",permalink:"/zh-CN/docs/2.0/gettingStarted/tutorials/building-lakehouse/doris-iceberg"},next:{title:"\u6784\u5efa\u65e5\u5fd7\u5b58\u50a8\u4e0e\u5206\u6790\u5e73\u53f0",permalink:"/zh-CN/docs/2.0/gettingStarted/tutorials/log-storage-analysis"}},c={},i=[{value:"Apache Doris &amp; LakeSoul",id:"apache-doris--lakesoul",level:2},{value:"\u4f7f\u7528\u6307\u5357",id:"\u4f7f\u7528\u6307\u5357",level:2},{value:"01 \u73af\u5883\u51c6\u5907",id:"01-\u73af\u5883\u51c6\u5907",level:3},{value:"02 \u73af\u5883\u90e8\u7f72",id:"02-\u73af\u5883\u90e8\u7f72",level:3},{value:"03 \u6570\u636e\u67e5\u8be2",id:"03-\u6570\u636e\u67e5\u8be2",level:3},{value:"04 CDC \u8868\u652f\u6301",id:"04-cdc-\u8868\u652f\u6301",level:3}],u={toc:i},p="wrapper";function g(e){let{components:t,...s}=e;return(0,l.yg)(p,(0,a.A)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,l.yg)("p",null,"\u4f5c\u4e3a\u4e00\u79cd\u5168\u65b0\u7684\u5f00\u653e\u5f0f\u7684\u6570\u636e\u7ba1\u7406\u67b6\u6784\uff0c\u6e56\u4ed3\u4e00\u4f53\uff08Data Lakehouse\uff09\u878d\u5408\u4e86\u6570\u636e\u4ed3\u5e93\u7684\u9ad8\u6027\u80fd\u3001\u5b9e\u65f6\u6027\u4ee5\u53ca\u6570\u636e\u6e56\u7684\u4f4e\u6210\u672c\u3001\u7075\u6d3b\u6027\u7b49\u4f18\u52bf\uff0c\u5e2e\u52a9\u7528\u6237\u66f4\u52a0\u4fbf\u6377\u5730\u6ee1\u8db3\u5404\u79cd\u6570\u636e\u5904\u7406\u5206\u6790\u7684\u9700\u6c42\uff0c\u5728\u4f01\u4e1a\u7684\u5927\u6570\u636e\u4f53\u7cfb\u4e2d\u5df2\u7ecf\u5f97\u5230\u8d8a\u6765\u8d8a\u591a\u7684\u5e94\u7528\u3002"),(0,l.yg)("p",null,"\u5728\u8fc7\u53bb\u591a\u4e2a\u7248\u672c\u4e2d\uff0cApache Doris \u6301\u7eed\u52a0\u6df1\u4e0e\u6570\u636e\u6e56\u7684\u878d\u5408\uff0c\u5f53\u524d\u5df2\u6f14\u8fdb\u51fa\u4e00\u5957\u6210\u719f\u7684\u6e56\u4ed3\u4e00\u4f53\u89e3\u51b3\u65b9\u6848\u3002"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"\u81ea 0.15 \u7248\u672c\u8d77\uff0cApache Doris \u5f15\u5165 Hive \u548c Iceberg \u5916\u90e8\u8868\uff0c\u5c1d\u8bd5\u5728 Apache Iceberg \u4e4b\u4e0a\u63a2\u7d22\u4e0e\u6570\u636e\u6e56\u7684\u80fd\u529b\u7ed3\u5408\u3002"),(0,l.yg)("li",{parentName:"ul"},"\u81ea 1.2 \u7248\u672c\u8d77\uff0cApache Doris \u6b63\u5f0f\u5f15\u5165 Multi-Catalog \u529f\u80fd\uff0c\u5b9e\u73b0\u4e86\u591a\u79cd\u6570\u636e\u6e90\u7684\u81ea\u52a8\u5143\u6570\u636e\u6620\u5c04\u548c\u6570\u636e\u8bbf\u95ee\u3001\u5e76\u5bf9\u5916\u90e8\u6570\u636e\u8bfb\u53d6\u548c\u67e5\u8be2\u6267\u884c\u7b49\u65b9\u9762\u505a\u4e86\u8bf8\u591a\u6027\u80fd\u4f18\u5316\uff0c\u5b8c\u5168\u5177\u5907\u4e86\u6784\u5efa\u6781\u901f\u6613\u7528 Lakehouse \u67b6\u6784\u7684\u80fd\u529b\u3002"),(0,l.yg)("li",{parentName:"ul"},"\u5728 2.1 \u7248\u672c\u4e2d\uff0cApache Doris \u6e56\u4ed3\u4e00\u4f53\u67b6\u6784\u5f97\u5230\u5168\u9762\u52a0\u5f3a\uff0c\u4e0d\u4ec5\u589e\u5f3a\u4e86\u4e3b\u6d41\u6570\u636e\u6e56\u683c\u5f0f\uff08Hudi\u3001Iceberg\u3001Paimon \u7b49\uff09\u7684\u8bfb\u53d6\u548c\u5199\u5165\u80fd\u529b\uff0c\u8fd8\u5f15\u5165\u4e86\u591a SQL \u65b9\u8a00\u517c\u5bb9\u3001\u53ef\u4ece\u539f\u6709\u7cfb\u7edf\u65e0\u7f1d\u5207\u6362\u81f3 Apache Doris\u3002\u5728\u6570\u636e\u79d1\u5b66\u53ca\u5927\u89c4\u6a21\u6570\u636e\u8bfb\u53d6\u573a\u666f\u4e0a\uff0cDoris \u96c6\u6210\u4e86 Arrow Flight \u9ad8\u901f\u8bfb\u53d6\u63a5\u53e3\uff0c\u4f7f\u5f97\u6570\u636e\u4f20\u8f93\u6548\u7387\u5b9e\u73b0 100 \u500d\u7684\u63d0\u5347\u3002")),(0,l.yg)("p",null,(0,l.yg)("img",{alt:"\u4f7f\u7528 Doris \u548c LakeSoul \u6784\u5efa Lakehouse",src:n(799694).A,width:"2560",height:"1280"})),(0,l.yg)("h2",{id:"apache-doris--lakesoul"},"Apache Doris & LakeSoul"),(0,l.yg)("p",null,"LakeSoul \u662f\u7531\u6570\u5143\u7075\u5f00\u53d1\u7684\u4e91\u539f\u751f\u6e56\u4ed3\u6846\u67b6\uff0c\u5e76\u5728 2023 \u5e74 5 \u6708\u6350\u8d60\u7ed9\u4e86 Linux \u57fa\u91d1\u4f1a AI & Data \u57fa\u91d1\u4f1a\u3002\u5b83\u4ee5\u5143\u6570\u636e\u7ba1\u7406\u7684\u9ad8\u53ef\u6269\u5c55\u6027\u3001ACID \u4e8b\u52a1\u3001\u9ad8\u6548\u7075\u6d3b\u7684 upsert \u64cd\u4f5c\u3001\u6a21\u5f0f\u6f14\u53d8\u548c\u6279\u6d41\u96c6\u6210\u5904\u7406\u4e3a\u7279\u70b9\u3002"),(0,l.yg)("p",null,"\u501f\u52a9 Apache Doris \u7684\u9ad8\u6027\u80fd\u67e5\u8be2\u5f15\u64ce\u548c LakeSoul \u7684\u9ad8\u6548\u6570\u636e\u7ba1\u7406\uff0c\u7528\u6237\u53ef\u4ee5\u5b9e\u73b0\uff1a"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"\u5b9e\u65f6\u6570\u636e\u5165\u6e56\uff1a\u5229\u7528 LakeSoul \u7684\u67b6\u6784\uff0c\u6570\u636e\u53ef\u4ee5\u4ee5\u9ad8\u6548\u7387\u548c\u4f4e\u5ef6\u8fdf\u5165\u6e56\uff0c\u652f\u6301\u5305\u62ec\u805a\u5408\u3001\u53bb\u91cd\u548c\u90e8\u5206\u5217\u66f4\u65b0\u5728\u5185\u7684\u5404\u79cd\u6570\u636e\u66f4\u65b0\u80fd\u529b\u3002"),(0,l.yg)("li",{parentName:"ul"},"\u9ad8\u6027\u80fd\u6570\u636e\u5904\u7406\u548c\u5206\u6790\uff1aLakeSoul \u7684\u6279\u6d41\u96c6\u6210\u5904\u7406\u548c\u6a21\u5f0f\u6f14\u53d8\u7b49\u80fd\u529b\u53ef\u4ee5\u4e0e Doris \u7684\u5f3a\u5927\u67e5\u8be2\u5f15\u64ce\u65e0\u7f1d\u96c6\u6210\uff0c\u5b9e\u73b0\u6e56\u6570\u636e\u7684\u5feb\u901f\u67e5\u8be2\u548c\u5206\u6790\u54cd\u5e94\u3002\n\u672a\u6765\uff0cApache Doris \u5c06\u9010\u6b65\u652f\u6301 LakeSoul \u7684\u66f4\u591a\u9ad8\u7ea7\u529f\u80fd\uff0c\u5982 CDC \u6d41\u540c\u6b65\u548c\u81ea\u52a8\u6a21\u5f0f\u6f14\u53d8\uff0c\u5171\u540c\u6784\u5efa\u7edf\u4e00\u7684\u3001\u9ad8\u6027\u80fd\u7684\u3001\u5b9e\u65f6\u7684\u6e56\u4ed3\u5e73\u53f0\u3002")),(0,l.yg)("p",null,"\u672c\u6587\u5c06\u89e3\u91ca\u5982\u4f55\u5feb\u901f\u642d\u5efa Apache Doris + LakeSoul \u6d4b\u8bd5\u548c\u6f14\u793a\u73af\u5883\uff0c\u5e76\u6f14\u793a\u5404\u79cd\u529f\u80fd\u7684\u4f7f\u7528\u65b9\u6cd5\uff0c\u5c55\u793a\u5728\u6e56\u4ed3\u67b6\u6784\u4e2d\u4f7f\u7528\u4e24\u4e2a\u7cfb\u7edf\u96c6\u6210\u548c\u4f18\u52bf\u3002"),(0,l.yg)("p",null,"\u5173\u4e8e\u66f4\u591a\u8bf4\u660e\uff0c\u8bf7\u53c2\u9605 ",(0,l.yg)("a",{parentName:"p",href:"../../../lakehouse/datalake-analytics/lakesoul"},"LakeSoul Catalog")),(0,l.yg)("h2",{id:"\u4f7f\u7528\u6307\u5357"},"\u4f7f\u7528\u6307\u5357"),(0,l.yg)("p",null,"\u672c\u6587\u6d89\u53ca\u6240\u6709\u811a\u672c\u548c\u4ee3\u7801\u53ef\u4ee5\u4ece\u8be5\u5730\u5740\u83b7\u53d6\uff1a",(0,l.yg)("a",{parentName:"p",href:"https://github.com/apache/doris/tree/master/samples/datalake/lakesoul"},"https://github.com/apache/doris/tree/master/samples/datalake/lakesoul")),(0,l.yg)("h3",{id:"01-\u73af\u5883\u51c6\u5907"},"01 \u73af\u5883\u51c6\u5907"),(0,l.yg)("p",null,"\u672c\u6587\u793a\u4f8b\u91c7\u7528 Docker Compose \u90e8\u7f72\uff0c\u7ec4\u4ef6\u53ca\u7248\u672c\u53f7\u5982\u4e0b\uff1a"),(0,l.yg)("table",null,(0,l.yg)("thead",{parentName:"table"},(0,l.yg)("tr",{parentName:"thead"},(0,l.yg)("th",{parentName:"tr",align:null},"\u7ec4\u4ef6\u540d\u79f0"),(0,l.yg)("th",{parentName:"tr",align:null},"\u7248\u672c"))),(0,l.yg)("tbody",{parentName:"table"},(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Apache Doris"),(0,l.yg)("td",{parentName:"tr",align:null},"\u9ed8\u8ba4 3.0.2")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"LakeSoul"),(0,l.yg)("td",{parentName:"tr",align:null},"2.6.1")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Postgres"),(0,l.yg)("td",{parentName:"tr",align:null},"14.5")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Apache Spark"),(0,l.yg)("td",{parentName:"tr",align:null},"3.3.1")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Apache Flink"),(0,l.yg)("td",{parentName:"tr",align:null},"1.17")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"MinIO"),(0,l.yg)("td",{parentName:"tr",align:null},"RELEASE.2024-04-29T09-56-05Z")))),(0,l.yg)("h3",{id:"02-\u73af\u5883\u90e8\u7f72"},"02 \u73af\u5883\u90e8\u7f72"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"\u542f\u52a8\u6240\u6709\u7ec4\u4ef6")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"```\nbash ./start_all.sh\n```\n")),(0,l.yg)("ol",{start:2},(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("p",{parentName:"li"},"\u542f\u52a8\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u811a\u672c\u767b\u5f55\u5230 Doris \u547d\u4ee4\u884c\uff1a"),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre"},"-- login doris\nbash ./start_doris_client.sh\n")))),(0,l.yg)("h3",{id:"03-\u6570\u636e\u67e5\u8be2"},"03 \u6570\u636e\u67e5\u8be2"),(0,l.yg)("p",null,"\u5982\u4e0b\u6240\u793a\uff0c\u5728 Doris \u96c6\u7fa4\u4e2d\u5df2\u7ecf\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3a lakesoul \u7684 Catalog\uff08\u53ef\u4f7f\u7528 SHOW CATALOGS \u67e5\u770b\uff09\u3002\u4ee5\u4e0b\u662f\u8be5 Catalog \u7684\u521b\u5efa\u8bed\u53e5\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"  -- Already created\n  CREATE CATALOG `lakesoul` PROPERTIES (\n    'type'='lakesoul',\n    'lakesoul.pg.username'='lakesoul_test',\n    'lakesoul.pg.password'='lakesoul_test',\n    'lakesoul.pg.url'='jdbc:postgresql://lakesoul-meta-pg:5432/lakesoul_test?stringtype=unspecified',\n    'minio.endpoint'='http://minio:9000',\n    'minio.access_key'='admin',\n    'minio.secret_key'='password'\n  );\n\n")),(0,l.yg)("p",null,"  LakeSoul \u8868 ",(0,l.yg)("inlineCode",{parentName:"p"},"lakesoul.tpch.customer")," \u5df2\u52a0\u8f7d\u5230 Doris \u4e2d\u3002\u5728 Doris \u4e2d\u67e5\u8be2\u6570\u636e\u3002"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u67e5\u8be2\u6570\u636e"),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"Doris> use `lakesoul`.`tpch`;\nDatabase changed\n\nDoris> show tables;\n+---------------------+\n| Tables_in_tpch      |\n+---------------------+\n| customer_from_spark |\n+---------------------+\n1 row in set (0.00 sec)\n\nDoris> select * from customer_from_spark where c_nationkey = 1 order by c_custkey limit 4;\n+-----------+--------------------+-----------------------------------------+-------------+-----------------+-----------+--------------+--------------------------------------------------------------------------------------------------------+\n| c_custkey | c_name             | c_address                               | c_nationkey | c_phone         | c_acctbal | c_mktsegment | c_comment                                                                                              |\n+-----------+--------------------+-----------------------------------------+-------------+-----------------+-----------+--------------+--------------------------------------------------------------------------------------------------------+\n|         3 | Customer#000000003 | MG9kdTD2WBHm                            |           1 | 11-719-748-3364 |   7498.12 | AUTOMOBILE   |  deposits eat slyly ironic, even instructions. express foxes detect slyly. blithely even accounts abov |\n|        14 | Customer#000000014 | KXkletMlL2JQEA                          |           1 | 11-845-129-3851 |   5266.30 | FURNITURE    | , ironic packages across the unus                                                                      |\n|        30 | Customer#000000030 | nJDsELGAavU63Jl0c5NKsKfL8rIJQQkQnYL2QJY |           1 | 11-764-165-5076 |   9321.01 | BUILDING     | lithely final requests. furiously unusual account                                                      |\n|        59 | Customer#000000059 | zLOCP0wh92OtBihgspOGl4                  |           1 | 11-355-584-3112 |   3458.60 | MACHINERY    | ously final packages haggle blithely after the express deposits. furiou                                |\n+-----------+--------------------+-----------------------------------------+-------------+-----------------+-----------+--------------+--------------------------------------------------------------------------------------------------------+\n4 rows in set (3.14 sec)\n\nDoris> select * from customer_from_spark where c_nationkey = 1 order by c_custkey desc limit 4;\n+-----------+--------------------+-----------------------------------------+-------------+-----------------+-----------+--------------+-------------------------------------------------------------------------------------------------+\n| c_custkey | c_name             | c_address                               | c_nationkey | c_phone         | c_acctbal | c_mktsegment | c_comment                                                                                       |\n+-----------+--------------------+-----------------------------------------+-------------+-----------------+-----------+--------------+-------------------------------------------------------------------------------------------------+\n|     14983 | Customer#000014983 | ERN3vq5Fvt4DL                           |           1 | 11-424-279-1846 |    841.22 | AUTOMOBILE   | furiously slyly special foxes. express theodolites cajole carefully. special dinos haggle pinto |\n|     14968 | Customer#000014968 | ,sykKTZBzVFl7ito1750v2TRYwmkRl2nvqGHwmx |           1 | 11-669-222-9657 |   6106.77 | HOUSEHOLD    | ts above the furiously even deposits haggle across                                              |\n|     14961 | Customer#000014961 | JEIORcsBp6RpLYH 9gNdDyWJ                |           1 | 11-490-251-5554 |   4006.35 | HOUSEHOLD    | quests detect carefully final platelets! quickly final frays haggle slyly blithely final acc    |\n|     14940 | Customer#000014940 | bNoyCxPuqSwPLjbqjEUNGN d0mSP            |           1 | 11-242-677-1085 |   8829.48 | HOUSEHOLD    | ver the quickly express braids. regular dependencies haggle fluffily quickly i                  |\n+-----------+--------------------+-----------------------------------------+-------------+-----------------+-----------+--------------+-------------------------------------------------------------------------------------------------+\n4 rows in set (0.10 sec)\n"))),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u5206\u533a\u88c1\u526a\nDoris \u53ef\u4ee5\u5bf9 LakeSoul \u6267\u884c\u5206\u533a\u88c1\u526a\uff0c\u5e76\u901a\u8fc7\u539f\u751f\u8bfb\u53d6\u52a0\u901f\u67e5\u8be2\u8fc7\u7a0b\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 ",(0,l.yg)("inlineCode",{parentName:"p"},"explain verbose")," \u6765\u68c0\u67e5\u8fd9\u4e00\u70b9\u3002"))),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"```sql\nDoris> explain verbose select * from customer_from_spark where c_nationkey < 3;\n+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Explain String(Old Planner)                                                                                                                                          |\n+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| PLAN FRAGMENT 0                                                                                                                                                      |\n|   OUTPUT EXPRS:                                                                                                                                                      |\n|     `lakesoul`.`tpch`.`customer_from_spark`.`c_custkey`                                                                                                              |\n|     `lakesoul`.`tpch`.`customer_from_spark`.`c_name`                                                                                                                 |\n|     `lakesoul`.`tpch`.`customer_from_spark`.`c_address`                                                                                                              |\n|     `lakesoul`.`tpch`.`customer_from_spark`.`c_nationkey`                                                                                                            |\n|     `lakesoul`.`tpch`.`customer_from_spark`.`c_phone`                                                                                                                |\n|     `lakesoul`.`tpch`.`customer_from_spark`.`c_acctbal`                                                                                                              |\n|     `lakesoul`.`tpch`.`customer_from_spark`.`c_mktsegment`                                                                                                           |\n|     `lakesoul`.`tpch`.`customer_from_spark`.`c_comment`                                                                                                              |\n|   PARTITION: UNPARTITIONED                                                                                                                                           |\n|                                                                                                                                                                      |\n|   HAS_COLO_PLAN_NODE: false                                                                                                                                          |\n|                                                                                                                                                                      |\n|   VRESULT SINK                                                                                                                                                       |\n|      MYSQL_PROTOCAL                                                                                                                                                  |\n|                                                                                                                                                                      |\n|   1:VEXCHANGE                                                                                                                                                        |\n|      offset: 0                                                                                                                                                       |\n|      tuple ids: 0                                                                                                                                                    |\n|                                                                                                                                                                      |\n| PLAN FRAGMENT 1                                                                                                                                                      |\n|                                                                                                                                                                      |\n|   PARTITION: RANDOM                                                                                                                                                  |\n|                                                                                                                                                                      |\n|   HAS_COLO_PLAN_NODE: false                                                                                                                                          |\n|                                                                                                                                                                      |\n|   STREAM DATA SINK                                                                                                                                                   |\n|     EXCHANGE ID: 01                                                                                                                                                  |\n|     UNPARTITIONED                                                                                                                                                    |\n|                                                                                                                                                                      |\n|   0:VplanNodeName                                                                                                                                                    |\n|      table: customer_from_spark                                                                                                                                      |\n|      predicates: (`c_nationkey` < 3)                                                                                                                                 |\n|      inputSplitNum=12, totalFileSize=0, scanRanges=12                                                                                                                |\n|      partition=0/0                                                                                                                                                   |\n|      backends:                                                                                                                                                       |\n|        10002                                                                                                                                                         |\n|          s3://lakesoul-test-bucket/data/tpch/customer_from_spark/c_nationkey=1/part-00000-0568c817-d6bc-4fa1-bb9e-b311069b131c_00000.c000.parquet start: 0 length: 0 |\n|          s3://lakesoul-test-bucket/data/tpch/customer_from_spark/c_nationkey=1/part-00001-d99a8fe6-61ab-4285-94da-2f84f8746a8a_00001.c000.parquet start: 0 length: 0 |\n|          s3://lakesoul-test-bucket/data/tpch/customer_from_spark/c_nationkey=1/part-00002-8a8e396f-685f-4b0f-87fa-e2a3fe5be87e_00002.c000.parquet start: 0 length: 0 |\n|          ... other 8 files ...                                                                                                                                       |\n|          s3://lakesoul-test-bucket/data/tpch/customer_from_spark/c_nationkey=0/part-00003-d5b598cd-5bed-412c-a26f-bb4bc9c937bc_00003.c000.parquet start: 0 length: 0 |\n|      numNodes=1                                                                                                                                                      |\n|      pushdown agg=NONE                                                                                                                                               |\n|      tuple ids: 0                                                                                                                                                    |\n|                                                                                                                                                                      |\n| Tuples:                                                                                                                                                              |\n| TupleDescriptor{id=0, tbl=customer_from_spark}                                                                                                                       |\n|   SlotDescriptor{id=0, col=c_custkey, colUniqueId=0, type=int, nullable=false, isAutoIncrement=false, subColPath=null}                                               |\n|   SlotDescriptor{id=1, col=c_name, colUniqueId=1, type=text, nullable=true, isAutoIncrement=false, subColPath=null}                                                  |\n|   SlotDescriptor{id=2, col=c_address, colUniqueId=2, type=text, nullable=true, isAutoIncrement=false, subColPath=null}                                               |\n|   SlotDescriptor{id=3, col=c_nationkey, colUniqueId=3, type=int, nullable=false, isAutoIncrement=false, subColPath=null}                                             |\n|   SlotDescriptor{id=4, col=c_phone, colUniqueId=4, type=text, nullable=true, isAutoIncrement=false, subColPath=null}                                                 |\n|   SlotDescriptor{id=5, col=c_acctbal, colUniqueId=5, type=decimalv3(15,2), nullable=true, isAutoIncrement=false, subColPath=null}                                    |\n|   SlotDescriptor{id=6, col=c_mktsegment, colUniqueId=6, type=text, nullable=true, isAutoIncrement=false, subColPath=null}                                            |\n|   SlotDescriptor{id=7, col=c_comment, colUniqueId=7, type=text, nullable=true, isAutoIncrement=false, subColPath=null}                                               |\n+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n57 rows in set (0.03 sec)\n\n```\n\n\n\u901a\u8fc7\u68c0\u67e5 `EXPLAIN VERBOSE` \u8bed\u53e5\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u770b\u5230\u8c13\u8bcd\u6761\u4ef6 `c_nationkey < 3` \u6700\u7ec8\u53ea\u547d\u4e2d\u4e00\u4e2a\u5206\u533a\uff08partition=0/0\uff09\u3002\n")),(0,l.yg)("h3",{id:"04-cdc-\u8868\u652f\u6301"},"04 CDC \u8868\u652f\u6301"),(0,l.yg)("p",null,"\u542f\u52a8 Flink CDC \u4f5c\u4e1a\u4ee5\u540c\u6b65 MySQL \u8868\u3002MySQL \u8868\u5728\u542f\u52a8 ",(0,l.yg)("inlineCode",{parentName:"p"},"start_all.sh")," \u65f6\u5df2\u7ecf\u88ab\u52a0\u8f7d\u4e86\u3002"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"bash start_flink_cdc_job.sh\n")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"Start flink-cdc job...\nSLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/opt/flink/lib/log4j-slf4j-impl-2.17.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/opt/hadoop/share/hadoop/common/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]\nLoading class `com.mysql.jdbc.Driver'. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver'. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.\nJob has been submitted with JobID d1b3641dcd1ad85c6b373d49b1867e68\n\n")),(0,l.yg)("p",null,"Flink CDC \u4f5c\u4e1a\u5c06\u542f\u52a8\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u91cd\u65b0\u521b\u5efa LakeSoul Catalog \u5728 ",(0,l.yg)("inlineCode",{parentName:"p"},"doris client")," \u4e2d\u68c0\u67e5\u542f\u52a8\u8fc7\u7a0b\u3002Flink CDC \u4f5c\u4e1a\u542f\u52a8\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 ",(0,l.yg)("inlineCode",{parentName:"p"},"doris client")," \u4e2d\u770b\u5230\u6b63\u5728\u540c\u6b65\u7684 LakeSoul CDC \u8868\u3002"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"Doris> show tables;\n+---------------------+\n| Tables_in_tpch      |\n+---------------------+\n| customer_from_spark |\n+---------------------+\n2 rows in set (0.00 sec)\n\n\nDoris> drop catalog if exists lakesoul;\nQuery OK, 0 rows affected (0.00 sec)\n\nDoris> create catalog `lakesoul`  properties ('type'='lakesoul', 'lakesoul.pg.username'='lakesoul_test', 'lakesoul.pg.password'='lakesoul_test', 'lakesoul.pg.url'='jdbc:postgresql://lakesoul-meta-pg:5432/lakesoul_test?stringtype=unspecified', 'minio.endpoint'='http://minio:9000', 'minio.access_key'='admin', 'minio.secret_key'='password');\nQuery OK, 0 rows affected (0.01 sec)\n\nDoris> show tables;\n+---------------------+\n| Tables_in_tpch      |\n+---------------------+\n| customer            |\n| customer_from_spark |\n+---------------------+\n2 rows in set (0.00 sec)\n\nDoris> select c_custkey, c_name, c_address, c_nationkey , c_phone, c_acctbal , c_mktsegment , c_comment from lakesoul.tpch.customer where c_custkey < 10;\n+-----------+--------------------+---------------------------------------+-------------+-----------------+-----------+--------------+-------------------------------------------------------------------------------------------------------------------+\n| c_custkey | c_name             | c_address                             | c_nationkey | c_phone         | c_acctbal | c_mktsegment | c_comment                                                                                                         |\n+-----------+--------------------+---------------------------------------+-------------+-----------------+-----------+--------------+-------------------------------------------------------------------------------------------------------------------+\n|         1 | Customer#000000001 | IVhzIApeRb ot,c,E                     |          15 | 25-989-741-2988 |    711.56 | BUILDING     | to the even, regular platelets. regular, ironic epitaphs nag e                                                    |\n|         3 | Customer#000000003 | MG9kdTD2WBHm                          |           1 | 11-719-748-3364 |   7498.12 | AUTOMOBILE   |  deposits eat slyly ironic, even instructions. express foxes detect slyly. blithely even accounts abov            |\n|         7 | Customer#000000007 | TcGe5gaZNgVePxU5kRrvXBfkasDTea        |          18 | 28-190-982-9759 |   9561.95 | AUTOMOBILE   | ainst the ironic, express theodolites. express, even pinto beans among the exp                                    |\n|         8 | Customer#000000008 | I0B10bB0AymmC, 0PrRYBCP1yGJ8xcBPmWhl5 |          17 | 27-147-574-9335 |   6819.74 | BUILDING     | among the slyly regular theodolites kindle blithely courts. carefully even theodolites haggle slyly along the ide |\n|         2 | Customer#000000002 | XSTf4,NCwDVaWNe6tEgvwfmRchLXak        |          13 | 23-768-687-3665 |    121.65 | AUTOMOBILE   | l accounts. blithely ironic theodolites integrate boldly: caref                                                   |\n|         4 | Customer#000000004 | XxVSJsLAGtn                           |           4 | 14-128-190-5944 |   2866.83 | MACHINERY    |  requests. final, regular ideas sleep final accou                                                                 |\n|         5 | Customer#000000005 | KvpyuHCplrB84WgAiGV6sYpZq7Tj          |           3 | 13-750-942-6364 |    794.47 | HOUSEHOLD    | n accounts will have to unwind. foxes cajole accor                                                                |\n|         6 | Customer#000000006 | sKZz0CsnMD7mp4Xd0YrBvx,LREYKUWAh yVn  |          20 | 30-114-968-4951 |   7638.57 | AUTOMOBILE   | tions. even deposits boost according to the slyly bold packages. final accounts cajole requests. furious          |\n|         9 | Customer#000000009 | xKiAFTjUsCuxfeleNqefumTrjS            |           8 | 18-338-906-3675 |   8324.07 | FURNITURE    | r theodolites according to the requests wake thinly excuses: pending requests haggle furiousl                     |\n+-----------+--------------------+---------------------------------------+-------------+-----------------+-----------+--------------+-------------------------------------------------------------------------------------------------------------------+\n9 rows in set (1.09 sec)\n\n")),(0,l.yg)("p",null,"\u8fdb\u5165 ",(0,l.yg)("inlineCode",{parentName:"p"},"mysql client")," \u5e76\u5c1d\u8bd5\u4fee\u6539\u6570\u636e\u3002"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"bash start_mysql_client.sh\n")),(0,l.yg)("p",null,"\u5c1d\u8bd5\u4ece ",(0,l.yg)("inlineCode",{parentName:"p"},"mysql client")," \u66f4\u65b0\u884c\u3002"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"mysql> update customer set c_acctbal=2211.26 where c_custkey=1;\nQuery OK, 1 row affected (0.01 sec)\nRows matched: 1  Changed: 1  Warnings: 0\n")),(0,l.yg)("p",null,"\u56de\u5230 ",(0,l.yg)("inlineCode",{parentName:"p"},"doris client")," \u5e76\u68c0\u67e5\u6570\u636e\u53d8\u5316\u3002"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"Doris> select c_custkey, c_name, c_address, c_nationkey , c_phone, c_acctbal , c_mktsegment , c_comment from lakesoul.tpch.customer where c_custkey < 10;\n+-----------+--------------------+---------------------------------------+-------------+-----------------+-----------+--------------+-------------------------------------------------------------------------------------------------------------------+\n| c_custkey | c_name             | c_address                             | c_nationkey | c_phone         | c_acctbal | c_mktsegment | c_comment                                                                                                         |\n+-----------+--------------------+---------------------------------------+-------------+-----------------+-----------+--------------+-------------------------------------------------------------------------------------------------------------------+\n|         2 | Customer#000000002 | XSTf4,NCwDVaWNe6tEgvwfmRchLXak        |          13 | 23-768-687-3665 |    121.65 | AUTOMOBILE   | l accounts. blithely ironic theodolites integrate boldly: caref                                                   |\n|         4 | Customer#000000004 | XxVSJsLAGtn                           |           4 | 14-128-190-5944 |   2866.83 | MACHINERY    |  requests. final, regular ideas sleep final accou                                                                 |\n|         5 | Customer#000000005 | KvpyuHCplrB84WgAiGV6sYpZq7Tj          |           3 | 13-750-942-6364 |    794.47 | HOUSEHOLD    | n accounts will have to unwind. foxes cajole accor                                                                |\n|         6 | Customer#000000006 | sKZz0CsnMD7mp4Xd0YrBvx,LREYKUWAh yVn  |          20 | 30-114-968-4951 |   7638.57 | AUTOMOBILE   | tions. even deposits boost according to the slyly bold packages. final accounts cajole requests. furious          |\n|         9 | Customer#000000009 | xKiAFTjUsCuxfeleNqefumTrjS            |           8 | 18-338-906-3675 |   8324.07 | FURNITURE    | r theodolites according to the requests wake thinly excuses: pending requests haggle furiousl                     |\n|         1 | Customer#000000001 | IVhzIApeRb ot,c,E                     |          15 | 25-989-741-2988 |   2211.26 | BUILDING     | to the even, regular platelets. regular, ironic epitaphs nag e                                                    |\n|         3 | Customer#000000003 | MG9kdTD2WBHm                          |           1 | 11-719-748-3364 |   7498.12 | AUTOMOBILE   |  deposits eat slyly ironic, even instructions. express foxes detect slyly. blithely even accounts abov            |\n|         7 | Customer#000000007 | TcGe5gaZNgVePxU5kRrvXBfkasDTea        |          18 | 28-190-982-9759 |   9561.95 | AUTOMOBILE   | ainst the ironic, express theodolites. express, even pinto beans among the exp                                    |\n|         8 | Customer#000000008 | I0B10bB0AymmC, 0PrRYBCP1yGJ8xcBPmWhl5 |          17 | 27-147-574-9335 |   6819.74 | BUILDING     | among the slyly regular theodolites kindle blithely courts. carefully even theodolites haggle slyly along the ide |\n+-----------+--------------------+---------------------------------------+-------------+-----------------+-----------+--------------+-------------------------------------------------------------------------------------------------------------------+\n9 rows in set (0.11 sec)\n\n")),(0,l.yg)("p",null,"\u5c1d\u8bd5\u4ece ",(0,l.yg)("inlineCode",{parentName:"p"},"mysql client")," \u5220\u9664\u884c\u3002"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"mysql> delete from customer where c_custkey = 2;\nQuery OK, 1 row affected (0.01 sec)\n")),(0,l.yg)("p",null,"\u56de\u5230 ",(0,l.yg)("inlineCode",{parentName:"p"},"doris client")," \u5e76\u68c0\u67e5\u6570\u636e\u53d8\u5316\u3002"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"Doris> select c_custkey, c_name, c_address, c_nationkey , c_phone, c_acctbal , c_mktsegment , c_comment from lakesoul.tpch.customer where c_custkey < 10;\n+-----------+--------------------+---------------------------------------+-------------+-----------------+-----------+--------------+-------------------------------------------------------------------------------------------------------------------+\n| c_custkey | c_name             | c_address                             | c_nationkey | c_phone         | c_acctbal | c_mktsegment | c_comment                                                                                                         |\n+-----------+--------------------+---------------------------------------+-------------+-----------------+-----------+--------------+-------------------------------------------------------------------------------------------------------------------+\n|         6 | Customer#000000006 | sKZz0CsnMD7mp4Xd0YrBvx,LREYKUWAh yVn  |          20 | 30-114-968-4951 |   7638.57 | AUTOMOBILE   | tions. even deposits boost according to the slyly bold packages. final accounts cajole requests. furious          |\n|         9 | Customer#000000009 | xKiAFTjUsCuxfeleNqefumTrjS            |           8 | 18-338-906-3675 |   8324.07 | FURNITURE    | r theodolites according to the requests wake thinly excuses: pending requests haggle furiousl                     |\n|         1 | Customer#000000001 | IVhzIApeRb ot,c,E                     |          15 | 25-989-741-2988 |   2211.26 | BUILDING     | to the even, regular platelets. regular, ironic epitaphs nag e                                                    |\n|         3 | Customer#000000003 | MG9kdTD2WBHm                          |           1 | 11-719-748-3364 |   7498.12 | AUTOMOBILE   |  deposits eat slyly ironic, even instructions. express foxes detect slyly. blithely even accounts abov            |\n|         7 | Customer#000000007 | TcGe5gaZNgVePxU5kRrvXBfkasDTea        |          18 | 28-190-982-9759 |   9561.95 | AUTOMOBILE   | ainst the ironic, express theodolites. express, even pinto beans among the exp                                    |\n|         8 | Customer#000000008 | I0B10bB0AymmC, 0PrRYBCP1yGJ8xcBPmWhl5 |          17 | 27-147-574-9335 |   6819.74 | BUILDING     | among the slyly regular theodolites kindle blithely courts. carefully even theodolites haggle slyly along the ide |\n|         4 | Customer#000000004 | XxVSJsLAGtn                           |           4 | 14-128-190-5944 |   2866.83 | MACHINERY    |  requests. final, regular ideas sleep final accou                                                                 |\n|         5 | Customer#000000005 | KvpyuHCplrB84WgAiGV6sYpZq7Tj          |           3 | 13-750-942-6364 |    794.47 | HOUSEHOLD    | n accounts will have to unwind. foxes cajole accor                                                                |\n+-----------+--------------------+---------------------------------------+-------------+-----------------+-----------+--------------+-------------------------------------------------------------------------------------------------------------------+\n8 rows in set (0.11 sec)\n\n")))}g.isMDXComponent=!0},799694:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/lakehouse-architecture-for-doris-and-lakesoul-ef021d8b6de64a42b7c2ffdb3387114c.png"}}]);