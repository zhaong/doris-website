"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([[337319],{15680:(e,t,r)=>{r.d(t,{xA:()=>c,yg:()=>g});var n=r(296540);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=n.createContext({}),p=function(e){var t=n.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},c=function(e){var t=p(e.components);return n.createElement(i.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(r),m=a,g=u["".concat(i,".").concat(m)]||u[m]||d[m]||o;return r?n.createElement(g,l(l({ref:t},c),{},{components:r})):n.createElement(g,l({ref:t},c))}));function g(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,l=new Array(o);l[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[u]="string"==typeof e?e:a,l[1]=s;for(var p=2;p<o;p++)l[p]=r[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},318298:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var n=r(58168),a=(r(296540),r(15680));const o={title:"Deploy on Kubernetes",language:"en"},l=void 0,s={unversionedId:"install/cluster-deployment/k8s-deploy/install-quickstart",id:"version-2.1/install/cluster-deployment/k8s-deploy/install-quickstart",title:"Deploy on Kubernetes",description:"\x3c!--",source:"@site/versioned_docs/version-2.1/install/cluster-deployment/k8s-deploy/install-quickstart.md",sourceDirName:"install/cluster-deployment/k8s-deploy",slug:"/install/cluster-deployment/k8s-deploy/install-quickstart",permalink:"/docs/install/cluster-deployment/k8s-deploy/install-quickstart",draft:!1,tags:[],version:"2.1",frontMatter:{title:"Deploy on Kubernetes",language:"en"},sidebar:"docs",previous:{title:"Environment Requirements",permalink:"/docs/install/cluster-deployment/k8s-deploy/install-env"},next:{title:"Config Doris to Deploy",permalink:"/docs/install/cluster-deployment/k8s-deploy/install-config-cluster"}},i={},p=[{value:"Step 1: Deploy Doris Operator",id:"step-1-deploy-doris-operator",level:2},{value:"Step 2: Deploy Doris cluster",id:"step-2-deploy-doris-cluster",level:2},{value:"Step 3: Access the Doris cluster",id:"step-3-access-the-doris-cluster",level:2}],c={toc:p},u="wrapper";function d(e){let{components:t,...r}=e;return(0,a.yg)(u,(0,n.A)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("p",null,"This section describes how to deploy Doris Operator and Doris cluster in the test Kubernetes cluster.\nThe deployment operations are as follows:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Deploy Doris Operator"),(0,a.yg)("li",{parentName:"ol"},"Deploy Doris cluster"),(0,a.yg)("li",{parentName:"ol"},"Connect to Doris cluster")),(0,a.yg)("h2",{id:"step-1-deploy-doris-operator"},"Step 1: Deploy Doris Operator"),(0,a.yg)("p",null,"Deploying Doris Operator consists of two parts: installing the definition and deploying the operator service:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Installing Doris Operator CRD\nAdd the custom resource (CRD) of Doris Operator using the following command:"),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"kubectl create -f https://raw.githubusercontent.com/apache/doris-operator/master/config/crd/bases/doris.apache.com_dorisclusters.yaml\n"))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Install Doris Operator\nInstall Doris Operator using the following command:"),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"kubectl apply -f https://raw.githubusercontent.com/apache/doris-operator/master/config/operator/operator.yaml\n")),(0,a.yg)("p",{parentName:"li"},"Expected output:"),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"namespace/doris created\nrole.rbac.authorization.k8s.io/leader-election-role created\nrolebinding.rbac.authorization.k8s.io/leader-election-rolebinding created\nclusterrole.rbac.authorization.k8s.io/doris-operator created\nclusterrolebinding.rbac.authorization.k8s.io/doris-operator-rolebinding created\nserviceaccount/doris-operator created\ndeployment.apps/doris-operator created\n"))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Check the Doris Operator status\nCheck the deployment status of Doris Operator using the following command:"),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"kubectl get pods -n doris\n")),(0,a.yg)("p",{parentName:"li"},"Expected output:"),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"NAME                              READY   STATUS    RESTARTS   AGE\ndoris-operator-7f578c86cb-nz6jn   1/1     Running   0          19m\n")))),(0,a.yg)("h2",{id:"step-2-deploy-doris-cluster"},"Step 2: Deploy Doris cluster"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Download the template Doris deployment template:",(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"curl -O https://raw.githubusercontent.com/apache/doris-operator/master/doc/examples/doriscluster-sample.yaml\n"))),(0,a.yg)("li",{parentName:"ol"},"Perform customized configuration as needed according to the doc of ",(0,a.yg)("a",{parentName:"li",href:"/docs/install/cluster-deployment/k8s-deploy/install-config-cluster"},"Config Doris to Deploy"),". After the configuration is completed, deploy it with the following command:",(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"kubectl apply -f doriscluster-sample.yaml\n"))),(0,a.yg)("li",{parentName:"ol"},"Check the cluster deployment status:\nCheck the status of the cluster by checking the status of pods:",(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"kubectl get pods\n")),"Expected output:",(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"NAME                       READY   STATUS    RESTARTS   AGE\ndoriscluster-sample-fe-0   1/1     Running   0          2m\ndoriscluster-sample-be-0   1/1     Running   0          3m\n")),"Check the status of the deployed resources:",(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"kubectl get dcr -n doris\n")),"Expected output:",(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"NAME                  FESTATUS    BESTATUS    CNSTATUS   BROKERSTATUS\ndoriscluster-sample   available   available\n")))),(0,a.yg)("h2",{id:"step-3-access-the-doris-cluster"},"Step 3: Access the Doris cluster"),(0,a.yg)("p",null,"The Doris cluster is quickly deployed in the test environment. You can enter the container FE and use the MySQL Client to connect to Doris for test operations. For other access methods, refer to ",(0,a.yg)("a",{parentName:"p",href:"/docs/install/cluster-deployment/k8s-deploy/install-config-cluster#access-configuration"},"Accessing Doris Cluster")," for configuration."),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Get the FE container name:"),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"kubectl get pod -n doris | grep fe\ndoriscluster-sample-fe-0          1/1     Running   0          16m\n")),(0,a.yg)("p",{parentName:"li"},"In this example, the FE container is named doriscluster-sample-fe-0.")),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Enter the FE container:"),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"kubectl -n doris exec -it doriscluster-sample-fe-0 /bin/bash\n"))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Use MySQL Client to connect to the Doris cluster in the FE container:"),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-shell"},"mysql -uroot -P9030 -h127.0.0.1\n")))))}d.isMDXComponent=!0}}]);